# 游戏窗口坐标定位器

这是一个用于定位游戏窗口内坐标位置的工具，可以帮助你精确获取游戏界面中各个元素的位置坐标。

## 功能特性

- **实时坐标显示**: 显示鼠标的屏幕绝对坐标和窗口相对坐标
- **窗口状态监控**: 实时显示游戏窗口的连接状态、大小和位置
- **坐标捕获**: 按空格键快速捕获当前鼠标在游戏窗口内的坐标
- **历史记录**: 保存和管理捕获的坐标历史
- **数据持久化**: 支持将坐标保存到JSON文件并重新加载
- **简单易用**: 直观的图形界面，支持快捷键操作

## 使用方法

### 启动工具

```bash
# 方法1: 使用启动脚本
python run_coordinate_locator.py

# 方法2: 直接运行
python backend/tools/coordinate_locator.py
```

### 操作说明

1. **确保游戏窗口已打开** - 工具会自动检测游戏窗口
2. **将鼠标移动到目标位置** - 在游戏窗口中移动鼠标到你想要定位的位置
3. **捕获坐标** - 按空格键或点击"捕获当前坐标"按钮
4. **保存坐标** - 点击"保存坐标"按钮将捕获的坐标保存到文件
5. **查看历史** - 在历史记录区域查看所有捕获的坐标

### 快捷键

- `空格键`: 捕获当前坐标
- `ESC`: 退出程序

## 界面说明

### 窗口状态区域
- 显示游戏窗口的连接状态
- 显示窗口标题、大小和位置信息
- 状态指示器显示窗口是否正常连接

### 实时坐标区域
- **屏幕坐标**: 鼠标在屏幕上的绝对位置
- **窗口坐标**: 鼠标在游戏窗口内的相对位置
- **坐标状态**: 指示鼠标是否在游戏窗口内

### 控制按钮
- **捕获当前坐标**: 保存当前鼠标位置
- **清空历史**: 清除所有历史记录
- **保存坐标**: 将坐标保存到文件
- **加载坐标**: 从文件加载之前保存的坐标

### 历史记录区域
- 显示所有操作的时间戳和详细信息
- 支持滚动查看大量历史记录

## 配置说明

工具会自动使用项目配置文件中的游戏窗口设置：

- 窗口标题: 默认为 "二重螺旋"
- 进程名: 默认为 "EM-Win64-Shipping.exe"
- 窗口分辨率: 默认为 1920x1080

如需修改，请编辑 `.env` 文件中的相关配置。

## 坐标文件格式

保存的坐标文件为JSON格式，包含以下信息：

```json
{
  "created_time": "2024-01-01T12:00:00",
  "game_window": "二重螺旋",
  "window_bounds": {
    "left": 100,
    "top": 100,
    "width": 1920,
    "height": 1080
  },
  "coordinates": [
    {
      "window_x": 960,
      "window_y": 540,
      "timestamp": "2024-01-01T12:00:00"
    }
  ]
}
```

## 故障排除

### 常见问题

1. **游戏窗口未找到**
   - 确保游戏窗口已打开
   - 检查窗口标题是否正确配置
   - 尝试点击"刷新窗口"按钮

2. **坐标不准确**
   - 确保游戏窗口大小与配置一致
   - 检查窗口是否被缩放
   - 确认鼠标在游戏窗口内

3. **工具无法启动**
   - 检查Python环境和依赖包
   - 确保有tkinter库支持
   - 检查pyautogui库是否正确安装

### 依赖要求

- Python 3.7+
- tkinter (Python标准库)
- pyautogui
- pygetwindow
- win32gui (Windows系统，可选)

## 技术细节

- 使用多线程实现实时坐标更新
- 基于现有的WindowManager类进行窗口管理
- 支持Windows API获取精确的客户端区域坐标
- 采用简单直接的GUI设计，避免复杂依赖